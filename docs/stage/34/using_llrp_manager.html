<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=9" />
  <meta name="generator" content="Doxygen 1.8.13" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RDMnet: Using the LLRP Manager API</title>
  <link href="tabs.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <link href="stylesheet.css" rel="stylesheet" type="text/css" />
  <!--BEGIN CUSTOM SCRIPTS-->
  <script type="text/javascript">
    $(function () {
      $.get('/RDMnet/docs/versions.txt', function (data) {
        if (data) {
          var lines = data.split('\n');
          if (lines.length > 0) {
            var version_select = $("#version_select").empty();
            lines.forEach(function (line) {
              line = line.trim();
              if (!line) {
                return;
              }
              line = line.split(':');
              var option_name = line[0].replace(/^v/, '');
              if (line.length > 1) {
                option_name += ' (' + line[1] + ')';
              }
              var option_val = '/RDMnet/docs/' + line[0];
              var option = $('<option></option>').attr("value", option_val)
                .text(option_name);
              if (window.location.pathname.match('docs/' + line[0])) {
                option = option.attr("selected", "selected");
              }
              version_select.append(option);
            });
          }
        }
      }, 'text');
    });
  </script>
  <script type="text/javascript">
    $(function () { selectAllC() });
  </script>
  <script type="text/javascript">
    function selectAllC() {
      // Enable all C-language blocks
      var tabcontent = document.getElementsByClassName("tabcontent");
      for (i = 0; i < tabcontent.length; i++) {
        if (tabcontent[i].id.endsWith("_c")) {
          tabcontent[i].style.display = "block";
        } else {
          tabcontent[i].style.display = "none"
        }
      }
      // Enable all C-language buttons
      var tablinks = document.getElementsByClassName("tablinks");
      for (i = 0; i < tablinks.length; i++) {
        if (tablinks[i].id.endsWith("_c")) {
          if (!tablinks[i].className.includes("active")) {
            tablinks[i].className = tablinks[i].className += " active";
          }
        } else {
          tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
      }
    }
    function selectAllCpp() {
      // Enable all C++-language blocks
      var tabcontent = document.getElementsByClassName("tabcontent");
      for (i = 0; i < tabcontent.length; i++) {
        if (tabcontent[i].id.endsWith("_cpp")) {
          tabcontent[i].style.display = "block";
        } else {
          tabcontent[i].style.display = "none"
        }
      }
      // Enable all C++-language buttons
      var tablinks = document.getElementsByClassName("tablinks");
      for (i = 0; i < tablinks.length; i++) {
        if (tablinks[i].id.endsWith("_cpp")) {
          if (!tablinks[i].className.includes("active")) {
            tablinks[i].className = tablinks[i].className += " active";
          }
        } else {
          tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
      }
    }
    function selectLanguage(evt, block_id, language) {
      // Get all elements with class="tabcontent" and hide them
      var tabcontent = document.getElementsByClassName("tabcontent");
      for (i = 0; i < tabcontent.length; i++) {
        if (tabcontent[i].id.startsWith("div_" + block_id)) {
          tabcontent[i].style.display = "none";
        }
      }
      // Get all elements with class="tablinks" and remove the class "active"
      var tablinks = document.getElementsByClassName("tablinks");
      for (i = 0; i < tablinks.length; i++) {
        if (tablinks[i].id.startsWith("button_" + block_id)) {
          tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
      }
      // Show the current tab, and add an "active" class to the button that opened the tab
      document.getElementById("div_" + block_id + "_" + language).style.display = "block";
      if (!evt.currentTarget.className.includes("active")) {
        evt.currentTarget.className += " active";
      }
    }
  </script>
  <!--END CUSTOM SCRIPT-->
</head>
<body>
  <div id="top">
    <!-- do not remove this div, it is closed by doxygen! -->
    <div id="titlearea">
      <table cellspacing="0" cellpadding="0" style="width: 100%">
        <tbody>
          <tr style="height: 56px;">
            <td id="projectalign" style="padding-left: 0.5em;">
              <div id="projectname">RDMnet
                &#160;<span id="projectnumber">Staging for pull request 34</span>
              </div>
              <div id="projectbrief">Implementation of ANSI E1.33 (RDMnet)</div>
            </td>
            <!--BEGIN CUSTOM INSERTED SECTION-->
            <td style="text-align: right; padding-right: 0.5em">
              <div id="otherversions">
                View other versions:
                <select id="version_select" onchange="location = this.value">
                </select>
              </div>
            </td>
            <!--END CUSTOM INSERTED SECTION-->
          </tr>
        </tbody>
      </table>
    </div>
    <!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('using_llrp_manager.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Using the LLRP Manager API </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The LLRP Manager API exposes both a C and C++ language interface. The C++ interface is a header-only wrapper around the C interface.</p>
<p> 
<div class="tab">
  <button id="button_1_c" class="tablinks" onclick="selectAllC()">Show All C Snippets</button>
  <button id="button_1_cpp" class="tablinks" onclick="selectAllCpp()">Show All C++ Snippets</button>
</div>
</p>
<h2>Initialization</h2>
<p>The RDMnet library must be globally initialized before using the LLRP Manager API. See <a class="el" href="global_init_and_destroy.html">Global Initialization and Destruction</a>.</p>
<p>To create an LLRP manager instance, use the <a class="el" href="group__llrp__manager.html#gae5acadeaefcf9bc1b8075b6c36a54d4e" title="Create a new LLRP manager instance. ">llrp_manager_create()</a> function in C, or instantiate an rdmnet::LlrpManager and call its Startup() function in C++.</p>
<p>The LLRP manager API is an asynchronous, callback-oriented API. Part of the initial configuration for an LLRP manager instance is a set of function pointers (or abstract interface) for the library to use as callbacks. Callbacks are dispatched from the background thread that is started when the RDMnet library is initialized.</p>
<p>LLRP managers operate on a single network interface at a time. Network interfaces are tracked by OS-specific index (see the EtcPal doc page on <a class="elRef" doxygen="/home/vsts/work/1/s/external/EtcPal/docs/etcpal.tag:https://etclabs.github.io/EtcPal/docs/head/" href="https://etclabs.github.io/EtcPal/docs/head/interface_indexes.html">Network Interface Indexes</a>).</p>
<p> 
<div class="tab">
  <button id="button_2_c" class="tablinks" onclick="selectLanguage(event, '2', 'c')">C</button>
  <button id="button_2_cpp" class="tablinks" onclick="selectLanguage(event, '2', 'cpp')">C++</button>
</div>
<div id="div_2_c" class="tabcontent">
</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="llrp__manager_8h.html">rdmnet/llrp_manager.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="comment">// Sets optional values to defaults. </span></div><div class="line"><a class="code" href="struct_llrp_manager_config.html">LlrpManagerConfig</a> config = <a class="code" href="group__llrp__manager.html#ga463839b4dde4a691b121a41c4bf4a702">LLRP_MANAGER_CONFIG_DEFAULT_INIT</a>;</div><div class="line"></div><div class="line"><span class="comment">// Each LLRP manager is a component that must have a Component ID (CID), which is simply a UUID.</span></div><div class="line"><span class="comment">// Software should generate and save a CID so that the same one is used on each run of the software.</span></div><div class="line"><a class="codeRef" doxygen="/home/vsts/work/1/s/external/EtcPal/docs/etcpal.tag:https://etclabs.github.io/EtcPal/docs/head/" href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__uuid.html#gabb977b5a218b4b62224c016bf3932f10">etcpal_generate_os_preferred_uuid</a>(&amp;config.<a class="code" href="struct_llrp_manager_config.html#a68b1eac8be5285f8cdf20c94caa744ea">cid</a>);</div><div class="line"></div><div class="line"><span class="comment">// Specify the network interface and IP protocol that this manager should operate on.</span></div><div class="line">config.<a class="code" href="struct_llrp_manager_config.html#af02bdd2c50b185f560bc6b23fa5f3556">netint</a>.<a class="code" href="struct_rdmnet_mcast_netint_id.html#a96926c16976f31f92fb076adf001ef94">index</a> = manager_netint_index;</div><div class="line">config.<a class="code" href="struct_llrp_manager_config.html#af02bdd2c50b185f560bc6b23fa5f3556">netint</a>.<a class="code" href="struct_rdmnet_mcast_netint_id.html#a4d56ed87c8919fe9b6e40081f3140ffd">ip_type</a> = <a class="codeRef" doxygen="/home/vsts/work/1/s/external/EtcPal/docs/etcpal.tag:https://etclabs.github.io/EtcPal/docs/head/" href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__inet.html#gga847282e3fd17bf75ec83292326c455eea73ea615eceba61f26d92a63f3738f635">kEtcPalIpTypeV4</a>;</div><div class="line"></div><div class="line"><span class="comment">// Provide your ESTA manufacturer ID. If you have not yet requested an ESTA manufacturer ID, the</span></div><div class="line"><span class="comment">// range 0x7ff0 to 0x7fff can be used for prototyping.</span></div><div class="line">config.<a class="code" href="struct_llrp_manager_config.html#ab8867871acbf245a931cb57bdd7a6eee">manu_id</a> = MY_ESTA_MANUFACTURER_ID_VAL;</div><div class="line"></div><div class="line"><span class="comment">// Set the callback functions - defined elsewhere</span></div><div class="line"><span class="comment">// p_some_opaque_data is an opaque data pointer that will be passed back to each callback function</span></div><div class="line"><a class="code" href="group__llrp__manager.html#ga600905110d762ef671afd9de99a59ac9">llrp_manager_config_set_callbacks</a>(&amp;config, my_llrp_target_discovered_cb, my_llrp_rdm_response_received_cb,</div><div class="line">                                  my_llrp_discovery_finished_cb, p_some_opaque_data);</div><div class="line"></div><div class="line"><a class="code" href="group__llrp__manager.html#ga16b293cf63d5672e5f4652722b43c017">llrp_manager_t</a> my_manager_handle;</div><div class="line"><a class="codeRef" doxygen="/home/vsts/work/1/s/external/EtcPal/docs/etcpal.tag:https://etclabs.github.io/EtcPal/docs/head/" href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__error.html#ga743b0648f0ca798ef29c9f69c6e255af">etcpal_error_t</a> result = <a class="code" href="group__llrp__manager.html#gae5acadeaefcf9bc1b8075b6c36a54d4e">llrp_manager_create</a>(&amp;config, &amp;my_manager_handle);</div><div class="line"><span class="keywordflow">if</span> (result == <a class="codeRef" doxygen="/home/vsts/work/1/s/external/EtcPal/docs/etcpal.tag:https://etclabs.github.io/EtcPal/docs/head/" href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__error.html#gga743b0648f0ca798ef29c9f69c6e255afae403d046b4ba4e81dce121266c2cca8d">kEtcPalErrOk</a>)</div><div class="line">{</div><div class="line">  <span class="comment">// Handle is valid and may be referenced in later calls to API functions.</span></div><div class="line">}</div><div class="line"><span class="keywordflow">else</span></div><div class="line">{</div><div class="line">  <span class="comment">// Some error occurred, handle is not valid.</span></div><div class="line">}</div></div><!-- fragment --><p> 
</div>
<div id="div_2_cpp" class="tabcontent">
</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;rdmnet/cpp/llrp_manager.h&quot;</span></div><div class="line"></div><div class="line"><span class="comment">// A convenient construct to avoid having to write the entire rdmnet::llrp:: namespace prefix</span></div><div class="line"><span class="comment">// before LLRP API calls.</span></div><div class="line"><span class="keyword">namespace </span>llrp = <a class="code" href="namespacerdmnet_1_1llrp.html">rdmnet::llrp</a>;</div><div class="line"></div><div class="line"><span class="keyword">class </span>MyLlrpNotifyHandler : <span class="keyword">public</span> llrp::Manager::NotifyHandler</div><div class="line">{</div><div class="line">  <span class="comment">// Implement the NotifyHandler callbacks...</span></div><div class="line">};</div><div class="line"></div><div class="line">MyLlrpNotifyHandler my_llrp_notify_handler;</div><div class="line"></div><div class="line">llrp::Manager manager;</div><div class="line"><a class="codeRef" doxygen="/home/vsts/work/1/s/external/EtcPal/docs/etcpal.tag:https://etclabs.github.io/EtcPal/docs/head/" href="https://etclabs.github.io/EtcPal/docs/head/classetcpal_1_1_error.html">etcpal::Error</a> result = manager.Startup(</div><div class="line">    my_llrp_notify_handler,      <span class="comment">// Class instance to handle callbacks</span></div><div class="line">    MY_ESTA_MANUFACTURER_ID_VAL, <span class="comment">// Your ESTA manufacturer ID</span></div><div class="line">    manager_netint_index,        <span class="comment">// The network interface index to operate on</span></div><div class="line">    <a class="codeRef" doxygen="/home/vsts/work/1/s/external/EtcPal/docs/etcpal.tag:https://etclabs.github.io/EtcPal/docs/head/" href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__inet.html#gga847282e3fd17bf75ec83292326c455eea73ea615eceba61f26d92a63f3738f635">kEtcPalIpTypeV4</a>              <span class="comment">// The IP protocol type (V4 or V6) to use on the network interface</span></div><div class="line">);</div><div class="line"><span class="keywordflow">if</span> (result)</div><div class="line">{</div><div class="line">  <span class="comment">// Manager is valid and running.</span></div><div class="line">  llrp::Manager::Handle handle = manager.handle();</div><div class="line">  <span class="comment">// Store handle for later lookup from the NotifyHandler callback functions.</span></div><div class="line">}</div><div class="line"><span class="keywordflow">else</span></div><div class="line">{</div><div class="line">  <span class="comment">// Startup failed, use result.code() or result.ToString() to inspect details</span></div><div class="line">}</div></div><!-- fragment --><p> 
</div>
</p>
<h2>Deinitialization</h2>
<p>The LLRP manager should be shut down and destroyed gracefully before program termination. This will deallocate the manager's resources.</p>
<p> 
<div class="tab">
  <button id="button_3_c" class="tablinks" onclick="selectLanguage(event, '3', 'c')">C</button>
  <button id="button_3_cpp" class="tablinks" onclick="selectLanguage(event, '3', 'cpp')">C++</button>
</div>
<div id="div_3_c" class="tabcontent">
</p>
<div class="fragment"><div class="line"><a class="code" href="group__llrp__manager.html#gacf9b119488bff138ef961df9af1ab600">llrp_manager_destroy</a>(my_manager_handle);</div><div class="line"></div><div class="line"><span class="comment">// At this point, the manager is no longer running and its handle is no longer valid.</span></div></div><!-- fragment --><p> 
</div>
<div id="div_3_cpp" class="tabcontent">
</p>
<div class="fragment"><div class="line">manager.Shutdown();</div><div class="line"></div><div class="line"><span class="comment">// At this point, the manager is no longer running and its handle is no longer valid. It can be</span></div><div class="line"><span class="comment">// started again (with a new handle) by calling Startup() again.</span></div></div><!-- fragment --><p> 
</div>
</p>
<h2>Discovering Targets</h2>
<p>Start the LLRP discovery process using the functions in the snippet examples below. LLRP discovery continues in the background and typically takes a few seconds, but could take up to a minute or two in systems with large numbers of LLRP targets present.</p>
<p>LLRP has a filter bitfield with some options that can be used to limit the types of LLRP targets that respond to discovery.</p>
<p> 
<div class="tab">
  <button id="button_4_c" class="tablinks" onclick="selectLanguage(event, '4', 'c')">C</button>
  <button id="button_4_cpp" class="tablinks" onclick="selectLanguage(event, '4', 'cpp')">C++</button>
</div>
<div id="div_4_c" class="tabcontent">
</p>
<div class="fragment"><div class="line"><span class="comment">// To discover all LLRP targets...</span></div><div class="line"><a class="codeRef" doxygen="/home/vsts/work/1/s/external/EtcPal/docs/etcpal.tag:https://etclabs.github.io/EtcPal/docs/head/" href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__error.html#ga743b0648f0ca798ef29c9f69c6e255af">etcpal_error_t</a> result = <a class="code" href="group__llrp__manager.html#gaf767011a6d96b6a2692e313865a9b29d">llrp_manager_start_discovery</a>(my_manager_handle, 0);</div><div class="line"></div><div class="line"><span class="comment">// Or, to limit discovery to targets that are not currently connected to a broker via RDMnet...</span></div><div class="line"><a class="codeRef" doxygen="/home/vsts/work/1/s/external/EtcPal/docs/etcpal.tag:https://etclabs.github.io/EtcPal/docs/head/" href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__error.html#ga743b0648f0ca798ef29c9f69c6e255af">etcpal_error_t</a> result = <a class="code" href="group__llrp__manager.html#gaf767011a6d96b6a2692e313865a9b29d">llrp_manager_start_discovery</a>(my_manager_handle, LLRP_FILTERVAL_CLIENT_CONN_INACTIVE);</div><div class="line"></div><div class="line"><span class="comment">// Or, to limit discovery to RDMnet brokers...</span></div><div class="line"><a class="codeRef" doxygen="/home/vsts/work/1/s/external/EtcPal/docs/etcpal.tag:https://etclabs.github.io/EtcPal/docs/head/" href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__error.html#ga743b0648f0ca798ef29c9f69c6e255af">etcpal_error_t</a> result = <a class="code" href="group__llrp__manager.html#gaf767011a6d96b6a2692e313865a9b29d">llrp_manager_start_discovery</a>(my_manager_handle, LLRP_FILTERVAL_BROKERS_ONLY);</div><div class="line"></div><div class="line"><span class="keywordflow">if</span> (result == <a class="codeRef" doxygen="/home/vsts/work/1/s/external/EtcPal/docs/etcpal.tag:https://etclabs.github.io/EtcPal/docs/head/" href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__error.html#gga743b0648f0ca798ef29c9f69c6e255afae403d046b4ba4e81dce121266c2cca8d">kEtcPalErrOk</a>)</div><div class="line">{</div><div class="line">  <span class="comment">// Discovery is now ongoing and the associated callbacks will indicate when targets are discovered</span></div><div class="line">  <span class="comment">// and when discovery is finished.</span></div><div class="line">}</div></div><!-- fragment --><p> 
</div>
<div id="div_4_cpp" class="tabcontent">
</p>
<div class="fragment"><div class="line"><span class="comment">// To discover all LLRP targets...</span></div><div class="line"><a class="codeRef" doxygen="/home/vsts/work/1/s/external/EtcPal/docs/etcpal.tag:https://etclabs.github.io/EtcPal/docs/head/" href="https://etclabs.github.io/EtcPal/docs/head/classetcpal_1_1_error.html">etcpal::Error</a> result = manager.StartDiscovery();</div><div class="line"></div><div class="line"><span class="comment">// Or, to limit discovery to targets that are not currently connected to a broker via RDMnet...</span></div><div class="line"><a class="codeRef" doxygen="/home/vsts/work/1/s/external/EtcPal/docs/etcpal.tag:https://etclabs.github.io/EtcPal/docs/head/" href="https://etclabs.github.io/EtcPal/docs/head/classetcpal_1_1_error.html">etcpal::Error</a> result = manager.StartDiscovery(LLRP_FILTERVAL_CLIENT_CONN_INACTIVE);</div><div class="line"></div><div class="line"><span class="comment">// Or, to limit discovery to RDMnet brokers...</span></div><div class="line"><a class="codeRef" doxygen="/home/vsts/work/1/s/external/EtcPal/docs/etcpal.tag:https://etclabs.github.io/EtcPal/docs/head/" href="https://etclabs.github.io/EtcPal/docs/head/classetcpal_1_1_error.html">etcpal::Error</a> result = manager.StartDiscovery(LLRP_FILTERVAL_BROKERS_ONLY);</div><div class="line"></div><div class="line"><span class="keywordflow">if</span> (result)</div><div class="line">{</div><div class="line">  <span class="comment">// Discovery is now ongoing and the associated callbacks will indicate when targets are discovered</span></div><div class="line">  <span class="comment">// and when discovery is finished.</span></div><div class="line">}</div></div><!-- fragment --><p> 
</div>
</p>
<p>During discovery, callbacks will indicate when new LLRP targets are discovered and when discovery has finished. LLRP discovery finishes automatically after a timeout, but you can also call the relevant API function at any time to stop discovery early.</p>
<p> 
<div class="tab">
  <button id="button_5_c" class="tablinks" onclick="selectLanguage(event, '5', 'c')">C</button>
  <button id="button_5_cpp" class="tablinks" onclick="selectLanguage(event, '5', 'cpp')">C++</button>
</div>
<div id="div_5_c" class="tabcontent">
</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> handle_llrp_target_discovered(<a class="code" href="group__llrp__manager.html#ga16b293cf63d5672e5f4652722b43c017">llrp_manager_t</a> handle, <span class="keyword">const</span> <a class="code" href="struct_llrp_discovered_target.html">LlrpDiscoveredTarget</a>* target, <span class="keywordtype">void</span>* context)</div><div class="line">{</div><div class="line">  <span class="comment">// Check handle and/or context as necessary...</span></div><div class="line"></div><div class="line">  <span class="keywordtype">char</span> uid_str[<a class="codeRef" doxygen="/home/vsts/work/1/s/external/RDM/docs/RDM.tag:https://etclabs.github.io/RDM/docs/head/" href="https://etclabs.github.io/RDM/docs/head/group__uid.html#gaca68c70b4aca047a5b8ff73e9d73b492">RDM_UID_STRING_BYTES</a>];</div><div class="line">  <a class="codeRef" doxygen="/home/vsts/work/1/s/external/RDM/docs/RDM.tag:https://etclabs.github.io/RDM/docs/head/" href="https://etclabs.github.io/RDM/docs/head/group__uid.html#ga90190789ec0a4c7262c47e2d7a1fdf43">rdm_uid_to_string</a>(&amp;target-&gt;<a class="code" href="struct_llrp_discovered_target.html#a7740f59bfe2b2ad12087d2290f5bdf03">uid</a>, uid_str);</div><div class="line">  printf(<span class="stringliteral">&quot;Discovered new LLRP target with UID %s, target type %s\n&quot;</span>, uid_str,</div><div class="line">         <a class="code" href="group__rdmnet__api__common.html#ga953e59c75bae61dcd3f38fbc9227e888">llrp_component_type_to_string</a>(target-&gt;<a class="code" href="struct_llrp_discovered_target.html#aece7714b9daea51ddb2a14091c3d9ace">component_type</a>));</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> handle_llrp_discovery_finished(<a class="code" href="group__llrp__manager.html#ga16b293cf63d5672e5f4652722b43c017">llrp_manager_t</a> handle, <span class="keywordtype">void</span>* context)</div><div class="line">{</div><div class="line">  <span class="comment">// Check handle and/or context as necessary...</span></div><div class="line"></div><div class="line">  printf(<span class="stringliteral">&quot;LLRP discovery finished.\n&quot;</span>);</div><div class="line">}</div></div><!-- fragment --><p> 
</div>
<div id="div_5_cpp" class="tabcontent">
</p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>llrp = <a class="code" href="namespacerdmnet_1_1llrp.html">rdmnet::llrp</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> MyLlrpNotifyHandler::HandleLlrpTargetDiscovered(llrp::Manager::Handle handle,</div><div class="line">                                                     <span class="keyword">const</span> llrp::DiscoveredTarget&amp; target)</div><div class="line">{</div><div class="line">  <span class="comment">// Check handle as necessary...</span></div><div class="line"></div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;Discovered new LLRP target with UID &quot;</span> &lt;&lt; target.uid.ToString()</div><div class="line">            &lt;&lt; <span class="stringliteral">&quot;, target type &quot;</span> &lt;&lt; target.ComponentTypeToString() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> MyLlrpNotifyHandler::HandleLlrpDiscoveryFinished(llrp::Manager::Handle handle)</div><div class="line">{</div><div class="line">  <span class="comment">// Check handle as necessary...</span></div><div class="line"></div><div class="line">  std::cout &lt;&lt; <span class="stringliteral">&quot;LLRP discovery finished.\n&quot;</span>;</div><div class="line">}</div></div><!-- fragment --><p> 
</div>
</p>
<h2>Sending RDM Commands</h2>
<p>Once one or more LLRP targets have been discovered, an LLRP manager can send RDM commands addressed to them. LLRP targets must be tracked and addressed by a combination of RDM UID and CID; see <a class="el" href="roles_and_addressing.html">Roles and Addressing</a> and <a class="el" href="llrp.html">Low-Level Recovery Protocol (LLRP)</a> for more information on this. The DiscoveredTarget structure contains both of these addressing identifiers for each discovered target, and the DestinationAddr structure takes them to form an LLRP destination address.</p>
<p>The caller retains ownership of any data buffers supplied to the RDM command sending API functions. See <a class="el" href="data_ownership.html">Data Ownership Paradigms in the RDMnet Library</a> for more information.</p>
<p>After sending a command, the library will provide a <em>sequence number</em> that will be echoed in the corresponding RDM response. This sequence number should be saved.</p>
<p> 
<div class="tab">
  <button id="button_6_c" class="tablinks" onclick="selectLanguage(event, '6', 'c')">C</button>
  <button id="button_6_cpp" class="tablinks" onclick="selectLanguage(event, '6', 'cpp')">C++</button>
</div>
<div id="div_6_c" class="tabcontent">
</p>
<div class="fragment"><div class="line"><span class="comment">// Assuming we have an LlrpDiscoveredTarget structure named &#39;target&#39;...</span></div><div class="line"></div><div class="line"><a class="code" href="struct_llrp_destination_addr.html">LlrpDestinationAddr</a> dest = { target.cid, target.uid, 0 };</div><div class="line"></div><div class="line"><span class="comment">// Send a GET:DEVICE_LABEL command to an LLRP target</span></div><div class="line">uint32_t cmd_seq_num;</div><div class="line"><a class="codeRef" doxygen="/home/vsts/work/1/s/external/EtcPal/docs/etcpal.tag:https://etclabs.github.io/EtcPal/docs/head/" href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__error.html#ga743b0648f0ca798ef29c9f69c6e255af">etcpal_error_t</a> result = <a class="code" href="group__llrp__manager.html#ga6b0abe1eb48a9b17e321be18e88e5316">llrp_manager_send_get_command</a>(my_manager_handle, &amp;dest, E120_DEVICE_LABEL, NULL, 0,</div><div class="line">                                                      &amp;cmd_seq_num);</div><div class="line"><span class="keywordflow">if</span> (result == <a class="codeRef" doxygen="/home/vsts/work/1/s/external/EtcPal/docs/etcpal.tag:https://etclabs.github.io/EtcPal/docs/head/" href="https://etclabs.github.io/EtcPal/docs/head/group__etcpal__error.html#gga743b0648f0ca798ef29c9f69c6e255afae403d046b4ba4e81dce121266c2cca8d">kEtcPalErrOk</a>)</div><div class="line">{</div><div class="line">  <span class="comment">// cmd_seq_num identifies this command transaction. Store it for when a response is received.</span></div><div class="line">}</div></div><!-- fragment --><p> 
</div>
<div id="div_6_cpp" class="tabcontent">
</p>
<div class="fragment"><div class="line"><span class="comment">// Send a GET:DEVICE_LABEL command to an LLRP target. Assuming we have an llrp::DiscoveredTarget</span></div><div class="line"><span class="comment">// structure named &#39;target&#39;...</span></div><div class="line"><a class="codeRef" doxygen="/home/vsts/work/1/s/external/EtcPal/docs/etcpal.tag:https://etclabs.github.io/EtcPal/docs/head/" href="https://etclabs.github.io/EtcPal/docs/head/classetcpal_1_1_expected.html">etcpal::Expected&lt;uint32_t&gt;</a> result = manager.SendGetCommand(target.address(), E120_DEVICE_LABEL);</div><div class="line"><span class="keywordflow">if</span> (result)</div><div class="line">{</div><div class="line">  <span class="comment">// *result identifies this command transaction. Store it for when a response is received.</span></div><div class="line">}</div></div><!-- fragment --><p> 
</div>
</p>
<h2>Handling RDM Responses</h2>
<p>Responses to commands you send will be delivered asynchronously through the "RDM response" callback.</p>
<p>Note that response callbacks reference data buffers owned by the library, which will be invalid when the callback returns. See <a class="el" href="data_ownership.html">Data Ownership Paradigms in the RDMnet Library</a> for more information.</p>
<p> 
<div class="tab">
  <button id="button_7_c" class="tablinks" onclick="selectLanguage(event, '7', 'c')">C</button>
  <button id="button_7_cpp" class="tablinks" onclick="selectLanguage(event, '7', 'cpp')">C++</button>
</div>
<div id="div_7_c" class="tabcontent">
</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> handle_llrp_rdm_response(<a class="code" href="group__llrp__manager.html#ga16b293cf63d5672e5f4652722b43c017">llrp_manager_t</a> handle, <span class="keyword">const</span> <a class="code" href="struct_llrp_rdm_response.html">LlrpRdmResponse</a>* resp, <span class="keywordtype">void</span>* context)</div><div class="line">{</div><div class="line">  <span class="comment">// Check handle and/or context as necessary...</span></div><div class="line"></div><div class="line">  <span class="comment">// Check the response&#39;s sequence number against the one(s) you stored earlier.</span></div><div class="line">  <span class="keywordflow">if</span> (resp-&gt;<a class="code" href="struct_llrp_rdm_response.html#a4f18e9a664b388e2e6cc2487bd461445">seq_num</a> == cmd_seq_num)</div><div class="line">  {</div><div class="line">    handle_response_data(resp-&gt;<a class="code" href="struct_llrp_rdm_response.html#a862f1a7a0616749399fe262f024764db">rdm_header</a>.<a class="codeRef" doxygen="/home/vsts/work/1/s/external/RDM/docs/RDM.tag:https://etclabs.github.io/RDM/docs/head/" href="https://etclabs.github.io/RDM/docs/head/struct_rdm_response_header.html#a43f5e73445b99b42061429682fdc78fc">param_id</a>, resp-&gt;<a class="code" href="struct_llrp_rdm_response.html#a24ab197a0c24d70c1b190e0457f5ac5a">rdm_data</a>, resp-&gt;<a class="code" href="struct_llrp_rdm_response.html#aa0e01ac95ed5e01c11e36bd97abca7cc">rdm_data_len</a>);</div><div class="line"></div><div class="line">    <span class="comment">// LlrpRdmResponse structures do not own their data and the data will be invalid when this callback</span></div><div class="line">    <span class="comment">// ends. To save the data for later processing:</span></div><div class="line">    <a class="code" href="struct_llrp_saved_rdm_response.html">LlrpSavedRdmResponse</a> saved_resp;</div><div class="line">    <a class="code" href="group__rdmnet__api__common.html#ga534978db963058f2913a62ac143f3a09">rdmnet_save_llrp_rdm_response</a>(resp, &amp;saved_resp);</div><div class="line">  }</div><div class="line">}</div></div><!-- fragment --><p> 
</div>
<div id="div_7_cpp" class="tabcontent">
</p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>llrp = <a class="code" href="namespacerdmnet_1_1llrp.html">rdmnet::llrp</a>;</div><div class="line"></div><div class="line"><span class="keywordtype">void</span> MyLlrpNotifyHandler::HandleLlrpRdmResponse(llrp::Manager::Handle handle, <span class="keyword">const</span> llrp::RdmResponse&amp; resp)</div><div class="line">{</div><div class="line">  <span class="comment">// Check handle as necessary...</span></div><div class="line"></div><div class="line">  <span class="comment">// Check the response&#39;s sequence number against the one(s) you stored earlier.</span></div><div class="line">  <span class="keywordflow">if</span> (resp.seq_num() == cmd_seq_num)</div><div class="line">  {</div><div class="line">    HandleResponseData(resp.param_id(), resp.data(), resp.data_len());</div><div class="line"></div><div class="line">    <span class="comment">// llrp::RdmResponse classes do not own their data and the data will be invalid when this</span></div><div class="line">    <span class="comment">// callback ends. To save the data for later processing:</span></div><div class="line">    llrp::SavedRdmResponse saved_resp = resp.Save();</div><div class="line">  }</div><div class="line">}</div></div><!-- fragment --><p> 
</div>
 </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="getting_started.html">Getting Started</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
